<h1>My bookings</h1>
<% @bookings.each do |booking| %>
  <p>Student: <%= link_to booking.student.first_name, booking_path(booking) %></p>
  <p>Slot: <%= booking.slot %></p>
  <p>Teacher: <%= booking.teacher.first_name %></p>

  <% if (booking.slot - DateTime.now()) > 86_400 %>
    <p><%= link_to 'Edit', edit_booking_path(booking) %></p>
    <p><%= link_to "Delete",
            booking_path(booking),
            method: :delete,
            data: { confirm: "Are you sure?" }%></p>
  <% end %>
<% end %>

<h1>My ratings</h1>
<% respect = [] %>
<% share = [] %>
<% control = [] %>
<% @bookings.each do |booking| %>
  <% respect << booking.respect_rating if !booking.respect_rating.nil? %>
  <% share << booking.share_rating if !booking.share_rating.nil? %>
  <% control << booking.control_rating if !booking.control_rating.nil? %>
<% end %>
<p>Respect Rating Average: <%= (respect.sum.to_f / respect.count) %></p>
<p>Share Rating Average: <%= (share.sum.to_f / share.count) %></p>
<p>Control Rating Average: <%= (control.sum.to_f / control.count) %></p>


<h1>My hours</h1>
<% validated_hours = 0 %>
<% booked_hours = 0 %>
<% hours_to_do = 20 %>

<% @bookings.each do |booking| %>
  <% validated_hours += 2 if (booking.slot - DateTime.now()) < 0 %>
  <% booked_hours += 2 if (booking.slot - DateTime.now()) > 0 %>
<% end %>
<% hours_to_do = hours_to_do - booked_hours - validated_hours %>
<% if hours_to_do >= 0 %>
  <% hours_to_do = hours_to_do %>
<% else %>
  <% hours_to_do = 0 %>
<% end %>

<p>Validated hours: <%= validated_hours %></p>
<p>Booked hours: <%= booked_hours %></p>
<p>Hours to do: <%= hours_to_do %></p>

